(()=>{"use strict";(()=>{const e=JSON.parse('{"EG":{"ygl":100000,"bnm":60000,"bonus":30000},"Qq":{"s4":{"t1":40,"t2":50,"t3":60,"t4":70},"s5":{"t1":50,"t2":60,"t3":70,"t4":80},"s6":{"t1":60,"t2":70,"t3":80,"t4":90},"s6s":{"t1":90,"t2":110,"t3":130,"t4":150}},"xp":{"s4":{"t1":[263,264,266,270,274,278,283,288,294,300,306,313,320,327,335,343,351,360,368,377,386,396,405,415,425,436,446,457,468,479,490,502,513,525,537,549,562,574,587],"t2":[300,302,305,309,314,320,326,332,340,347,355,364,373,382,392,402,412,423,434,445,456,468,481,493,506,519,532,545,559,573,587,602,617,632,647,662,678,694,710,726,743,759,776,793,811,828,846,864,882],"t3":[338,340,345,351,358,366,375,385,396,407,419,431,444,458,472,487,502,517,533,550,567,584,602,620,639,658,678,697,718,738,759,780,802,824,846,869,892,915,938,962,986,1011,1036,1061,1086,1112,1138,1164,1191,1217,1244,1272,1299,1327,1355,1384,1412,1441,1471],"t4":[375,380,389,402,416,432,450,470,490,513,536,561,587,614,642,671,702,733,765,798,831,866,902,938,975,1013,1052,1091,1131,1172,1214,1256,1299,1342,1387,1432,1477,1524,1570,1618,1666,1715,1764,1814,1864,1916,1967,2019,2072,2125,2179,2234,2289,2344,2400,2457,2514,2571,2629,2688,2747,2806,2866,2927,2988,3049,3111,3174,3237]},"s5":{"t1":[300,302,305,309,314,320,326,332,340,347,355,364,373,382,392,402,412,423,434,445,456,468,481,493,506,519,532,545,559,573,587,602,617,632,647,662,678,694,710,726,743,759,776,793,811,828,846,864,882],"t2":[338,340,345,351,358,366,375,385,396,407,419,431,444,458,472,487,502,517,533,550,567,584,602,620,639,658,678,697,718,738,759,780,802,824,846,869,892,915,938,962,986,1011,1036,1061,1086,1112,1138,1164,1191,1217,1244,1272,1299,1327,1355,1384,1412,1441,1471],"t3":[375,380,389,402,416,432,450,470,490,513,536,561,587,614,642,671,702,733,765,798,831,866,902,938,975,1013,1052,1091,1131,1172,1214,1256,1299,1342,1387,1432,1477,1524,1570,1618,1666,1715,1764,1814,1864,1916,1967,2019,2072,2125,2179,2234,2289,2344,2400,2457,2514,2571,2629,2688,2747,2806,2866,2927,2988,3049,3111,3174,3237],"t4":[413,419,431,446,464,485,507,532,559,587,617,648,681,715,751,788,826,865,906,948,990,1034,1079,1125,1172,1220,1269,1319,1370,1422,1474,1528,1582,1638,1694,1751,1808,1867,1926,1986,2047,2109,2171,2235,2299,2363,2429,2495,2562,2629,2697,2766,2836,2906,2977,3048,3121,3193,3267,3341,3416,3491,3567,3644,3721,3799,3877,3956,4036,4116,4197,4279,4360,4443,4526,4610,4694,4779,4863]},"s6":{"t1":[338,340,345,351,358,366,375,385,396,407,419,431,444,458,472,487,502,517,533,550,567,584,602,620,639,658,678,697,718,738,759,780,802,824,846,869,892,915,938,962,986,1011,1036,1061,1086,1112,1138,1164,1191,1217,1244,1272,1299,1327,1355,1384,1412,1441,1471],"t2":[375,380,389,402,416,432,450,470,490,513,536,561,587,614,642,671,702,733,765,798,831,866,902,938,975,1013,1052,1091,1131,1172,1214,1256,1299,1342,1387,1432,1477,1524,1570,1618,1666,1715,1764,1814,1864,1916,1967,2019,2072,2125,2179,2234,2289,2344,2400,2457,2514,2571,2629,2688,2747,2806,2866,2927,2988,3049,3111,3174,3237],"t3":[413,419,431,446,464,485,507,532,559,587,617,648,681,715,751,788,826,865,906,948,990,1034,1079,1125,1172,1220,1269,1319,1370,1422,1474,1528,1582,1638,1694,1751,1808,1867,1926,1986,2047,2109,2171,2235,2299,2363,2429,2495,2562,2629,2697,2766,2836,2906,2977,3048,3121,3193,3267,3341,3416,3491,3567,3644,3721,3799,3877,3956,4036,4116,4197,4279,4360,4443,4526,4610,4694,4779,4863],"t4":[435,442,455,471,491,513,538,564,593,624,656,690,725,762,801,841,882,925,968,1014,1060,1107,1156,1206,1256,1308,1361,1415,1470,1526,1583,1641,1699,1759,1820,1881,1944,2007,2071,2136,2202,2269,2336,2405,2474,2544,2614,2686,2758,2831,2905,2979,3054,3130,3207,3284,3362,3441,3520,3601,3681,3763,3845,3928,4011,4096,4180,4266,4352,4439,4526,4614,4703,4792,4882,4972,5063,5155,5247,5340,5433,5527,5622,5717,5813,5909,6006,6103,6201]},"s6s":{"t1":[390,394,400,409,419,430,443,457,472,487,504,522,540,559,579,600,621,643,666,689,713,737,762,788,814,841,868,896,925,954,983,1013,1043,1074,1105,1137,1169,1202,1235,1269,1303,1337,1372,1408,1443,1479,1516,1553,1590,1628,1666,1704,1743,1782,1822,1862,1902,1943,1984,2025,2067,2109,2152,2195,2238,2281,2325,2369,2414,2458,2504,2549,2595,2641,2687,2734,2781,2828,2876,2924,2972,3021,3070,3119,3168,3218,3268,3318,3369],"t2":[480,486,496,510,526,544,564,586,609,634,660,688,717,748,779,812,845,880,916,953,990,1029,1069,1110,1151,1193,1237,1281,1326,1371,1418,1465,1513,1562,1612,1662,1713,1765,1817,1870,1924,1978,2034,2089,2146,2203,2261,2319,2378,2438,2498,2559,2620,2682,2745,2808,2872,2936,3001,3067,3133,3199,3266,3334,3402,3471,3540,3610,3680,3751,3823,3894,3967,4040,4113,4187,4261,4336,4412,4488,4564,4641,4718,4796,4874,4953,5032,5111,5192,5272,5353,5435,5516,5599,5682,5765,5848,5933,6017,6102,6187,6273,6359,6446,6533,6621,6709,6797,6886],"t3":[495,502,514,530,549,570,594,620,647,677,708,740,775,810,847,886,925,966,1009,1052,1097,1142,1189,1237,1286,1336,1387,1439,1492,1545,1600,1656,1713,1770,1828,1888,1948,2009,2071,2133,2197,2261,2326,2392,2458,2525,2593,2662,2732,2802,2873,2945,3017,3090,3164,3239,3314,3390,3466,3543,3621,3700,3779,3858,3939,4020,4102,4184,4267,4350,4434,4519,4604,4690,4777,4864,4951,5040,5129,5218,5308,5398,5490,5581,5673,5766,5859,5953,6048,6143,6238,6334,6430,6527,6625,6723,6822,6921,7020,7121,7221,7322,7424,7526,7629,7732,7836,7940,8044,8149,8255,8361,8468,8575,8682,8790,8898,9007,9117,9227,9337,9448,9559,9670,9783,9895,10008,10122,10236],"t4":[600,607,619,635,654,676,700,726,754,783,815,848,882,918,956,994,1034,1076,1118,1162,1207,1253,1300,1349,1398,1448,1500,1552,1606,1660,1715,1772,1829,1887,1946,2005,2066,2128,2190,2253,2317,2382,2448,2514,2581,2649,2718,2787,2857,2928,3000,3072,3145,3219,3293,3369,3444,3521,3598,3676,3755,3834,3914,3994,4075,4157,4239,4322,4406,4490,4575,4661,4747,4833,4921,5009,5097,5186,5276,5366,5457,5548,5640,5732,5826,5919,6013,6108,6203,6299,6395,6492,6590,6687,6786,6885,6984,7084,7185,7286,7388,7490,7592,7695,7799,7903,8007,8113,8218,8324,8431,8538,8645,8753,8862,8971,9080,9190,9300,9411,9522,9634,9746,9859,9972,10086,10200,10314,10429,10545,10661,10777,10894,11011,11129,11247,11365,11484,11603,11723,11844,11964,12085,12207,12329,12451,12574,12697,12821]}},"iL":{"s4":[150,300,600,1200],"s5":[300,600,1200,2300],"s6":[600,1300,2400,4200],"s6s":[800,1500,2600,4400]}}'),t=class{constructor(e){this.el=document.getElementById(e)}show(){this.el.classList.add("md-show")}hide(){this.el.classList.remove("md-show")}toggle(){this.el.classList.toggle("md-show")}},s=class{constructor(e){(this.el=document.createElement("table")).className=e}addRow(e){const t=document.createElement("tr");for(let s=0;s<e.length;s++)t.appendChild(e[s]);return this.el.appendChild(t),this}addCol(e){const t=document.createElement("td");return e.hasOwnProperty("class")&&(t.className=e.class),e.hasOwnProperty("id")&&(t.id=e.id),e.hasOwnProperty("text")&&(t.innerHTML=e.text),e.hasOwnProperty("child")&&t.appendChild(e.child),e.hasOwnProperty("rowspan")&&t.setAttribute("rowspan",e.rowspan),e.hasOwnProperty("colspan")&&t.setAttribute("colspan",e.colspan),t}};({state:{campMember:[],countMember:0,xpPerMember:0},init(e={}){this.mergeOptions(e).defineEl().iniEvents().iniCamp().iniModal().bootstrap()},mergeOptions(e){const t={scavType:e.scavType||"ygl",scavBonus:e.scavBonus||!1,input:{name:e.name||"",star:e.star||6,tier:e.tier||1,lvl:e.lvl||1,xp:e.xp||0}};return this.state={...this.state,...t},this},defineEl(){return this.el={scavType:document.querySelectorAll('input[name="scav-type"]'),chkBonus:document.getElementById("chk-scav-bonus"),btnBonus:document.getElementById("btn-scav-bonus"),iptGoal:document.getElementById("ipt-goal"),modalAddMember:new t("modal-addmember"),total:document.getElementById("total")},this},iniEvents(){return[].forEach.call(this.el.scavType,(e=>{e.onchange=e=>{"bnm"===(e.target||e.currentTarget).value?(this.el.btnBonus.classList.remove("disabled"),this.state.scavType="bnm"):(this.el.btnBonus.classList.add("disabled"),this.state.scavType="ygl"),this.state.countMember&&this.calculate()}})),this.el.chkBonus.onchange=e=>{(e.target||e.currentTarget).checked?this.state.scavBonus=!0:this.state.scavBonus=!1,this.state.countMember&&this.calculate()},this.el.iptGoal.onkeyup=e=>{let t=(e.target||e.currentTarget).value;const s=t.toLowerCase().match(/^(\d*\.?\d+)?([mk])$/);if(s)if("m"===s[2])t=1e6*parseFloat(s[1]);else{if("k"!==s[2])return;t=1e3*parseFloat(s[1])}console.log(parseInt(t))},this},iniCamp(){const e=document.getElementById("camp"),t=this.el.campNodes=e.getElementsByTagName("li");return[].forEach.call(t,(e=>{e.onclick=e=>{const t=e.target||e.currentTarget;this.state.input.idx=parseInt(t.dataset.idx,10),this.el.modalAddMember.show()}})),this},iniModal(){(this.el.inputName=document.getElementById("ipt-name")).onkeyup=e=>{const t=e.target||e.currentTarget;this.state.input.name=t.value};const e=document.querySelectorAll("input[name=ipt-star]");[].forEach.call(e,(e=>{e.onchange=e=>{const t=e.target||e.currentTarget;this.state.input.star=t.value,this.setMaxLevel()}}));const t=document.querySelectorAll("input[name=ipt-tier]");[].forEach.call(t,(e=>{e.onchange=e=>{const t=e.target||e.currentTarget;this.state.input.tier=parseInt(t.value,10),this.setMaxLevel()}}));const s=this.el.inputLvl=document.getElementById("ipt-lvl");s.onkeyup=e=>{const t=e.target||e.currentTarget;t.value>150&&(t.value=150),this.state.input.lvl=parseInt(t.value,10)},s.onclick=function(){this.value&&this.setSelectionRange(0,2)};const a=this.el.inputXp=document.getElementById("ipt-xp");return a.onkeyup=e=>{const t=e.target||e.currentTarget;t.value>99999&&(t.value=99999),this.state.input.xp=parseInt(t.value,10)},a.onclick=function(){this.value&&this.setSelectionRange(0,4)},document.getElementById("btn-addtocamp"),document.getElementById("form-add").onsubmit=e=>{this.submitForm(e)},document.getElementById("btn-close-md").onclick=()=>{this.el.modalAddMember.hide()},this},bootstrap(){return document.getElementById(`scav-type-${this.state.scavType}`).checked=!0,document.getElementById(`ipt-star-${this.state.input.star}`).checked=!0,document.getElementById(`ipt-tier-${this.state.input.tier}`).checked=!0,document.getElementById("ipt-lvl").value=this.state.input.lvl,document.getElementById("ipt-xp").value=this.state.input.xp,"ygl"===this.state.scavType&&this.el.btnBonus.classList.add("disabled"),this.setMaxLevel(),this},setMaxLevel(){this.state.maxLevel=e.Qq[`s${this.state.input.star}`][`t${this.state.input.tier}`]},submitForm(e){if(e.preventDefault(),!(this.state.countMember>5))return this.addToCamp({...this.state.input}),this.el.modalAddMember.hide(),this.clearForm(),!1},addToCamp(e){this.state.campMember[e.idx]=e,this.state.countMember+=1,this.createMember(e)},getEmptyNodes(){let e;for(let t=0;t<5;t++)if(!this.el.campNodes[t].hasChildNodes()){e=t;break}return e},createMember(e){const t=document.createElement("div");t.className="fill",t.onclick=e=>{e.stopPropagation()},t.appendChild(this.addBtnRemove(e.idx)),t.appendChild(this.addTier(e.tier)),t.appendChild(this.addName(e.name)),t.appendChild(this.addStar(e.star)),t.appendChild(this.addDetailsBox(e)),t.appendChild(this.addXpGain(e.idx)),t.appendChild(this.addRenown(e.idx)),"6s"===e.star&&t.appendChild(this.addSClassIcon()),this.el.campNodes[e.idx].appendChild(t),this.calculate()},addBtnRemove(e){const t=document.createElement("span");return t.className="close",t.innerHTML="&times;",t.idx=e,t.onclick=e=>{e.stopPropagation();const t=e.target||e.currentTarget;this.removeMember(t.idx)},t},addTier(e){const t=document.createElement("div");t.className="tier-wrapper";for(let s=0;s<4;s++){const a=document.createElement("span");a.className="tier",s<e&&(a.className+=" fill"),t.appendChild(a)}return t},addName(e){const t=document.createElement("div");return t.className="sh-name",t.innerHTML=e,t},addStar(e){const t=document.createElement("div");t.className="sh-star",6==e&&(t.className+=" clr-amber"),"6s"===e&&(t.className+=" clr-purple",e=6);for(let s=0;s<e;s++){const e=document.createElement("i");e.className="icon icon-star",t.appendChild(e)}return t},addSClassIcon(){const e=document.createElement("div");e.className="sh-s-class";const t=document.createElement("i");return t.className="icon icon-s-class",e.appendChild(t),e},addDetailsBox(e){const t=document.createElement("i");t.className="icon icon-chevron-right";const a=new s("tbl-box");return a.addRow([a.addCol({class:"a",text:"lvl"}),a.addCol({class:"b",text:e.lvl}),a.addCol({class:"c",child:t,rowspan:2}),a.addCol({id:`lvl-${e.idx}`,class:"d"})]).addRow([a.addCol({class:"e",text:"xp"}),a.addCol({class:"f",text:e.xp}),a.addCol({id:`xp-to-${e.idx}`,class:"g"})]).addRow([a.addCol({id:`xp-left-${e.idx}`,class:"h f-safe",colspan:4})]).addRow([a.addCol({id:`self-${e.idx}`,class:"h f-safe",colspan:4})]),a.el},addXpGain(e){const t=document.createElement("div");t.className="sh-xpgain";const s=document.createElement("span");s.className="clr-lightyellow",s.innerHTML="Xp Gain ";const a=document.createElement("span");return a.id=`xp-gain-${e}`,t.appendChild(s),t.appendChild(a),t},addRenown(e){const t=document.createElement("div");t.className="sh-renown";const s=document.createElement("span");s.className="clr-lightyellow",s.style.marginRight=".4rem",s.innerHTML="Renown";const a=document.createElement("span");return a.id=`renown-${e}`,a.style.fontSize="1.4rem",a.className="clr-amber",t.appendChild(s),t.appendChild(a),t},removeMember(e){const t=this.el.campNodes[e];for(;t.firstChild;)t.removeChild(t.firstChild);this.state.campMember[e]=null,this.state.countMember-=1,this.calculate()},calculate(){this.state.xpPerMember=parseInt((e.EG[this.state.scavType]+this.getChallangeBonusXp())/this.state.countMember,10)||0;let t=0;for(let e=0;e<=4;e++)if(this.state.campMember[e]){const s=this.calculateMember(e);this.setResult(e,s),t+=s.renown}this.setTotal(t)},calculateMember(e){const t=this.getRemainingXpChart(e);let s=0,a=0,n=0,l=0;if(t.length){this.state.campMember[e].xp>t[0]&&(this.state.campMember[e].xp=t[0]),t[0]-=this.state.campMember[e].xp;for(let e=0;e<t.length;e++){if(s+=t[e],s>this.state.xpPerMember){a=e,n=this.state.xpPerMember+t[e]-s,s=this.state.xpPerMember,l=this.getRemainingXpTotal(t)-this.state.xpPerMember;break}a=e+1,n="max",l=0}}else n="max",l=0;const i=this.getSafe(e,this.state.xpPerMember);return{lvlGain:a,xp:n,xpGain:s,renown:this.getRenownPoint(e,a),xpLeft:l,safe:i}},getChallangeBonusXp(){return"bnm"===this.state.scavType&&this.state.scavBonus?3e4:0},getRemainingXpChart(t){return e.xp[`s${this.state.campMember[t].star}`][`t${this.state.campMember[t].tier}`].slice(this.state.campMember[t].lvl-1)},getRemainingXpTotal(e){let t=0;for(let s=0;s<e.length;s++)t+=e[s];return t},getSafe(t,s){const a=e.xp[`s${this.state.campMember[t].star}`][`t${this.state.campMember[t].tier}`];let n={lvl:0,xp:0};for(let e=a.length-1;e>=0;e--)if((s-=a[e])<0){n.lvl=e+1,n.xp=-s;break}return n},getRenownPoint(t,s){return e.iL[`s${this.state.campMember[t].star}`][this.state.campMember[t].tier-1]*s},setResult(e,t){const s=document.getElementById(`lvl-${e}`),a=document.getElementById(`xp-to-${e}`),n=document.getElementById(`xp-gain-${e}`),l=document.getElementById(`renown-${e}`),i=document.getElementById(`xp-left-${e}`),r=document.getElementById(`self-${e}`);s.innerHTML=this.state.campMember[e].lvl+t.lvlGain,a.innerHTML=t.xp.toLocaleString(),"max"===t.xp?(a.className="txt-max",a.innerHTML=`${t.xp}!`):(a.className="clr-success",a.innerHTML=t.xp.toLocaleString()),n.innerHTML=t.xpGain.toLocaleString(),l.innerHTML=t.renown.toLocaleString(),t.xpLeft?i.innerHTML=`xp to max: <span class="clr-lightyellow">${t.xpLeft.toLocaleString()}</span>`:i.innerHTML="",t.safe.lvl?r.innerHTML=`safe: lvl <span class="clr-lightyellow">${t.safe.lvl}</span> xp <span class="clr-lightyellow">${t.safe.xp.toLocaleString()}</span>`:r.innerHTML=""},setTotal(e){this.el.total.innerHTML=e.toLocaleString()},clearForm(){this.el.inputName.value="",this.el.inputLvl.value=1,this.el.inputXp.value=0,this.state.input.name="",this.state.input.lvl=1,this.state.input.xp=0}}).init()})()})();